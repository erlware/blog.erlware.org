<!DOCTYPE html>
<html lang="en-us" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Automatic Hex Package Publishing with Travis-CI &middot; Erlware Blog</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="canonical" href="/post/automatic-hex-package-publishing-with-travis-ci/" />

     <meta name="description" content="Note: Travis CI does not yet provide rebar3 as a build tool for Erlang projects, so you will have to include a rebar3 executable escript in your repository.
In " /> 

     
    
    <meta name="twitter:card" content="summary"/>
    
 
    <meta name="twitter:title" content="Automatic Hex Package Publishing with Travis-CI"/>
    <meta name="twitter:description" content="Note: Travis CI does not yet provide rebar3 as a build tool for Erlang projects, so you will have to include a rebar3 executable escript in your repository.
In "/>
    <meta name="twitter:url" content="/post/automatic-hex-package-publishing-with-travis-ci/" />
    <meta name="twitter:site" content="@"/>

    <meta property="og:site_name" content="Erlware Blog" />
    <meta property="og:title" content="Automatic Hex Package Publishing with Travis-CI &middot; Erlware Blog" />
    <meta property="og:url" content="/post/automatic-hex-package-publishing-with-travis-ci/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="Note: Travis CI does not yet provide rebar3 as a build tool for Erlang projects, so you will have to include a rebar3 executable escript in your repository.
In " />

    <meta property="article:published_time" content="2015-11-19T05:31:57Z" />
    


    <meta name="generator" content="Hugo 0.53" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="/built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="/css/casper-two.css" /> 
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    

     

</head>


<body class="ctsingle">

  <div class="site-wrapper"> 

<header class="site-header outer "  >
  <div class="inner">
    <div class="site-header-content">
      <h1 class="site-title">
        <img class="site-logo" src="/img/logo.png" alt="Erlware Blog" />
       </h1>
        <h2 class="site-description">Erlang tools and packaging </h2>
    </div>

    <nav class="site-nav">
      <div class="site-nav-left"><ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="/">Home</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/about">About</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    

                    <a class="social-link" href="https://github.com/erlware" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    

                    
        </div>  
            
      </div>

    </nav>  

  </div>
</header>


<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
    <div class="post-feed">
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="/post/automatic-hex-package-publishing-with-travis-ci/">
      <div class="post-card-image" style="background-image: url(/defimg/7.jpg)"></div>
    </a>    
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="/post/automatic-hex-package-publishing-with-travis-ci/">
          <header class="post-card-header">
              
              <h2 class="post-card-title">Automatic Hex Package Publishing with Travis-CI</h2>
          </header>
      </a>
      <section class="post-card-excerpt" style="padding: 0 25px;">
          <p><strong>Note</strong>: <a href="https://travis-ci.org">Travis CI</a> does not yet provide <a href="https://rebar3.org">rebar3</a> as a build tool for Erlang projects, so you will have to include a rebar3 executable escript in your repository.</p>

<p>In your application&rsquo;s <code>.app.src</code> file use <code>&quot;git&quot;</code> as the version. This will replace the version string with the current tag when publishing the hex package:</p>

<pre><code class="language-erlang">{vsn,&quot;git&quot;},
</code></pre>

<p>In the <code>.travis.yml</code> configuration add the below section so that the script <code>scripts/hex.sh</code> is run everytime a new tag is made:</p>

<pre><code>deploy:
  provider: script
  script: scripts/hex.sh
  on:
    tags: true
</code></pre>

<p>Create the script <code>hex.sh</code> under <code>scripts/</code> and make it executable:</p>

<pre><code class="language-bash">#!/usr/bin/env bash

## Setup hex user
mkdir -p ~/.hex
echo '{username,&lt;&lt;&quot;'${HEX_USERNAME}'&quot;&gt;&gt;}.' &gt; ~/.hex/hex.config
echo '{key,&lt;&lt;&quot;'${HEX_KEY}'&quot;&gt;&gt;}.' &gt;&gt; ~/.hex/hex.config

## Add the rebar3 hex plugin to global
mkdir -p ~/.config/rebar3
echo '{plugins, [rebar3_hex]}.' &gt; ~/.config/rebar3/rebar.config

./rebar3 hex publish &lt;&lt;EOF
y
EOF
</code></pre>

<p>In the script it relies on two environmental variables <code>$HEX_USERNAME</code> and <code>$HEX_KEY</code>. Using either the Travis CLI tool or web interface you can create these variables and have the values encrypted or unseen by viewers of your repository. For instructions see the Travis-CI <a href="http://docs.travis-ci.com/user/environment-variables/">environment variables docs</a>.</p>

      </section>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="/" alt="Author" />
          <span class="post-card-author"><a href="/">Tristan Sloughter</a></span>
      </footer>
    </div>
</article>
    </div>

    <nav class="pagination" role="navigation">
      
          <a class="newer-posts" href="/post/otp-21-new-sys_config_src-option-in-relx/">&larr; <span class="hide">Next Post</span></a>
      
      <span class="page-number">&nbsp;</span>
      
          <a class="older-posts" href="/post/rebar3-hex-plugin/"><span class="hide">Previous Post</span> &rarr;</a>
      
    </nav>

    
    
    

  </div>
</main>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="/"></a>  <br>
      
    </section>
    <nav class="site-footer-nav">
        <a href="/">Latest Posts</a>
        
        
        <a href="https://github.com/erlware" target="_blank" rel="noopener">Github</a>
        
        
    </nav>  
  </div>
</footer>

</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/js/jquery.fitvids.js"></script>

<script>hljs.initHighlightingOnLoad();</script>




</body></html>
